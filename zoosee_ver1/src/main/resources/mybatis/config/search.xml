<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="search">
	<select id="findAllPetsitterList" resultType="petsitterboardVO" parameterType="map">
	select page, petsitterboard_no, petsitterboard_title,price,petSize,petType,address,petsitterImg,houseImg
	from
	(
		select ceil(rownum/9) as page,petsitterboard_no,petsitterboard_title,price,petSize,petType,petsitterNo,address,petsitterImg,houseImg
		from
		(
			select pb.petsitterboard_no,pb.petsitterboard_title,a.price,a.petSize,a.petType,pb.petsitterNo,a.address,a.petsitterImg,a.houseImg
			from  
			(
				select pt.petsitterNo,pt.price,pt.petSize,pt.petType,m.address,pt.petsitterImg,pt.houseImg from pet_member m, petsitter pt where m.id=pt.id and m.address like '%'||#{address}||'%'
			) a, petsitterboard pb
			where a.petsitterNo = pb.petsitterNo order by pb.petsitterboard_no desc
		)
	) where page=#{pageNo}
	</select>
	
	<select id="petboardCount" resultType="int">
		select count(*) from petsitterboard
	</select>
	
	<select id="findAddressCount" resultType="int">
		select count(*) from  petsitterboard pb, petsitter pt, pet_member m
		where pt.petsitterNo = pb.petsitterNo and pt.id=m.id and m.address like '%'||#{value}||'%'
	</select>
</mapper>